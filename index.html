<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload Video to YouTube</title>
</head>
<body>
    <h1>YouTube Video Upload</h1>
    <button id="authButton">Authorize Google Account</button>
    <input type="file" id="videoFile" accept="video/*">
    <button id="uploadButton" style="display: none;">Upload Video</button>
    <p id="status"></p>

    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        const CLIENT_ID = '904318254344-e3u5riiue9olqttojjs9ptu0bng50f4v.apps.googleusercontent.com';
        const API_KEY = 'AIzaSyBkPGe5Omx22wstG3ISozc1XkFjqqY5idM';
        const SCOPES = 'https://www.googleapis.com/auth/youtube.upload';
        const REDIRECT_URI = 'http://localhost:8000/oauth2callback';

        let GoogleAuth;

        function handleClientLoad() {
            gapi.load('client:auth2', function () {
                gapi.auth2.init({
                    client_id: CLIENT_ID,
                    redirect_uri: REDIRECT_URI
                }).then(function (auth2) {
                    GoogleAuth = auth2;
                    document.getElementById('authButton').addEventListener('click', handleAuthClick);
                });
            });
        }

        function handleAuthClick() {
            GoogleAuth.signIn().then(function () {
                document.getElementById('uploadButton').style.display = 'block';
            }).catch(function (error) {
                console.error('Sign-in error:', error);
            });
        }

        function uploadVideo() {
            const file = document.getElementById('videoFile').files[0];
            if (!file) {
                alert('Please select a video file.');
                return;
            }

            gapi.client.setApiKey(API_KEY);
            gapi.client.load('youtube', 'v3', function () {
                const metadata = {
                    snippet: {
                        title: 'Uploaded via JavaScript',
                        description: 'A test video upload using the YouTube API',
                        tags: ['YouTube API', 'video upload'],
                    },
                    status: {
                        privacyStatus: 'private',
                    }
                };

                const request = gapi.client.youtube.videos.insert({
                    part: 'snippet,status',
                    resource: metadata,
                    media: { body: file }
                });

                request.execute(function (response) {
                    if (response.error) {
                        document.getElementById('status').innerText = 'Upload Error: ' + response.error.message;
                    } else {
                        document.getElementById('status').innerText = 'Video Uploaded!';
                    }
                });
            });
        }

        document.getElementById('uploadButton').addEventListener('click', uploadVideo);
        window.onload = handleClientLoad;
    </script>
</body>
</html>
