<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload Video to YouTube</title>
    <style>
        /* Add your styling here */
        .container {
            text-align: center;
            padding: 20px;
        }
        .upload-btn {
            padding: 10px 20px;
            margin: 10px;
            font-size: 16px;
        }
        .status-message {
            margin-top: 20px;
        }
        .success {
            color: green;
        }
        .error {
            color: red;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Upload Video to YouTube</h1>
        <button id="authButton" class="upload-btn">Authorize Google Account</button>
        <form id="uploadForm" enctype="multipart/form-data" style="display:none;">
            <div class="form-group">
                <label for="videoFile">Choose a video to upload</label>
                <input type="file" id="videoFile" name="videoFile" accept="video/*" required>
            </div>
            <div class="form-group">
                <button type="submit" id="uploadButton" class="upload-btn">Upload Video</button>
            </div>
        </form>
        <div id="statusMessage" class="status-message"></div>
    </div>

    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        const CLIENT_ID = '331493991112-0o3shepfun2the0p1b9ie92k3pst6b0p.apps.googleusercontent.com';  // Your Google Client ID
        const API_KEY = 'AIzaSyBkPGe5Omx22wstG3ISozc1XkFjqqY5idM';  // Your Google API Key
        const SCOPES = 'https://www.googleapis.com/auth/youtube.upload';
        const REDIRECT_URI = 'https://realscripts-q.github.io/namegen/';
        let GoogleAuth;

        // Load the Google API client
        function loadClient() {
            gapi.client.setApiKey(API_KEY);
            gapi.client.load('https://www.googleapis.com/discovery/v1/apis/youtube/v3/rest').then(function () {
                console.log("YouTube API loaded");
            });
        }

        // Authenticate and load the API client
        function handleClientLoad() {
            gapi.load('client:auth2', function () {
                gapi.auth2.init({
                    client_id: CLIENT_ID,
                    redirect_uri: REDIRECT_URI
                }).then(function (auth2) {
                    GoogleAuth = auth2;
                    if (GoogleAuth.isSignedIn.get()) {
                        document.getElementById('uploadForm').style.display = 'block';
                    } else {
                        document.getElementById('authButton').style.display = 'block';
                    }
                }, function(error) {
                    console.log('Error initializing Google Auth:', error);
                });
            });
        }

        // Sign in to Google account
        function handleAuthClick(event) {
            GoogleAuth.signIn().then(function () {
                document.getElementById('authButton').style.display = 'none';
                document.getElementById('uploadForm').style.display = 'block';
            }).catch(function(error) {
                console.error('Error signing in:', error);
            });
        }

        // Upload video to YouTube
        function uploadVideo(file) {
            const statusMessage = document.getElementById('statusMessage');
            const metadata = {
                snippet: {
                    title: 'Uploaded from JavaScript',
                    description: 'A video uploaded from JavaScript using YouTube API',
                    tags: ['YouTube API', 'video upload'],
                },
                status: {
                    privacyStatus: 'private',
                }
            };

            const request = gapi.client.youtube.videos.insert({
                part: 'snippet,status',
                resource: metadata,
                media: {
                    body: file
                }
            });

            request.execute(function (response) {
                if (response.error) {
                    statusMessage.innerHTML = "Error uploading video: " + response.error.message;
                    statusMessage.classList.add('error');
                } else {
                    statusMessage.innerHTML = "Video uploaded successfully!";
                    statusMessage.classList.add('success');
                }
            });
        }

        // Handle file selection and video upload
        document.getElementById('uploadForm').addEventListener('submit', function (event) {
            event.preventDefault();
            const videoFile = document.getElementById('videoFile').files[0];
            if (videoFile) {
                uploadVideo(videoFile);
            }
        });

        // Initialize the Google API client
        window.onload = function () {
            handleClientLoad();
            document.getElementById('authButton').addEventListener('click', handleAuthClick);
        };
    </script>
</body>
</html>
